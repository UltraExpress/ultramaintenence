<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Script for Google Sheets</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }

        h1 {
            color: #333;
        }

        button {
            padding: 10px 20px;
            margin: 10px 0;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        pre {
            background-color: #333;
            color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Google Sheets API Test</h1>
    <p>This page tests the following:</p>
    <ul>
        <li>Fetching all data from the master script.</li>
        <li>Posting data to update "Status" (Column F) for <strong>Part ID: 9_rsdp5</strong>.</li>
    </ul>

    <button id="fetchDataButton">Get All Data</button>
    <button id="postDataButton">Update Status for Part ID: 9_rsdp5</button>

    <h2>Response:</h2>
    <pre id="responseOutput">Click a button to see the result...</pre>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbyg8lCbqvnwdOmIHGZSWJCBsXbta1McPyBtI-6OYtHmPzA0dwFEWIFUNAMAicZKTIrfUg/exec";

        const responseOutput = document.getElementById('responseOutput');
        const fetchDataButton = document.getElementById('fetchDataButton');
        const postDataButton = document.getElementById('postDataButton');

        // Fetch all data
        fetchDataButton.addEventListener('click', async () => {
            responseOutput.textContent = "Fetching data...";
            try {
                const response = await fetch(`${API_URL}?action=getAllData`);
                const result = await response.json();

                if (result.status === "success") {
                    responseOutput.textContent = JSON.stringify(result.data, null, 2);
                } else {
                    throw new Error("Failed to fetch data");
                }
            } catch (error) {
                responseOutput.textContent = `Error: ${error.message}`;
            }
        });

        // Post data to update "Status" column
        postDataButton.addEventListener('click', async () => {
            responseOutput.textContent = "Posting data...";
            try {
                const payload = {
                    partId: "9_rsdp5",
                    columnName: "Status",
                    newValue: "Needs Approval"
                };

                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                if (result.status === "success") {
                    responseOutput.textContent = `Update successful: ${JSON.stringify(result, null, 2)}`;
                } else {
                    throw new Error("Failed to update status");
                }
            } catch (error) {
                responseOutput.textContent = `Error: ${error.message}`;
            }
        });
    </script>
</body>
</html>
